/* Copyright (c) Ericsson 2015 */

define("styles!widget/WfForm/WfForm.less",function(){return".eaNFE_automation_UI-WfForm-checkbox-label {\n  padding-right: 30px;\n}\n.eaNFE_automation_UI-WfForm-radio-label {\n  padding-right: 10px;\n}\n.eaNFE_automation_UI-WfForm-content {\n  padding-bottom: 10px;\n}\n.eaNFE_automation_UI-WfForm-contentToggle {\n  display: block;\n}\n"}),define("text!widget/WfForm/WfForm.html",function(){return'<div class="eaNFE_automation_UI-WfForm">\r\n	<div class="eaNFE_automation_UI-WfForm-contentToggle">\r\n	<form class="eaNFE_automation_UI-WfForm-content"></form>\r\n	</div>\r\n</div>'}),define("widget/WfForm/WfFormView",["jscore/core","text!./WfForm.html","styles!./WfForm.less"],function(e,t,l){return e.View.extend({getTemplate:function(){return t},getStyle:function(){return l},getFormContent:function(){return this.getElement().find(".eaNFE_automation_UI-WfForm-content")},getRequired:function(e){return this.getElement().find(".validation-notification-"+e)},getToolTip:function(e){return this.getElement().find(".ebToolTip-"+e)}})}),define("widget/WfForm/WfForm",["jscore/core","widgets/SelectBox","widgets/DatePicker","widgets/TimePicker","widgets/Spinner","./WfFormView","widgets/Notification","widgets/Tooltip"],function(e,t,l,n,o,r,a,i){return e.Widget.extend({View:r,onViewReady:function(){if(this.formModel=this.options.formModel,this.variableCollection=this.options.variableCollection,null!=this.formModel&&(this.formModel.toString().indexOf("\n")>-1||"json"!=this.formModel.attributes.formInfo.format))this.formModel.toString().indexOf("\n")>-1&&this.formModel.indexOf("")>=0&&(this.newFormElement=e.Element.parse(this.formModel),this.view.getElement().append(this.newFormElement));else{this.validateForm(),this.createVariables();var t="<table>";this.controlWidgets=[];for(var l=this.formModel.getAttribute("controlGroups"),n=0;n<l.length;n++){var o=l[n].controlGroup;t+="<tr>";var r="";"undefined"!=typeof o.controls[0].variable.required&&1==o.controls[0].variable.required&&(r="ebLabel-text_required"),"textparagraph"!=o.type&&(t+="<td>",t+="<label class='ebLabel ebToolTip-"+o.name+" "+r+"'>"+o.label+"</label>",t+="</td>");for(var a=this.createWidgetGroup(o),s=0;s<a.widgets.length;s++)this.controlWidgets.push(a.widgets[s]);t+=a.html,t+="<td>",t+="<table><tr>",t+="</tr></table>",t+="</td>",t+="</tr>"}t+="</table>",this.formElement=e.Element.parse(t);for(var n=0;n<this.controlWidgets.length;n++){var d=this.controlWidgets[n];null!=d.libWidget&&this.formElement.find("."+d.name).append(d.libWidget.getElement())}this.view.getFormContent().append(this.formElement);for(var n=0;n<l.length;n++){var o=l[n].controlGroup;if("undefined"!=typeof o.toolTip){var u=new i({parent:this.view.getToolTip(o.name),enabled:!0,contentText:o.toolTip,modifiers:[{name:"size",value:"large"}]});u.attachTo(this.getElement())}}}},getValues:function(e){var t=[],l=e.initialValue;return null!=l&&("instance"===l.source?t.push(this.variables[e.variable.name].value):"local"===l.source&&null!=l.value&&t.push(l.value)),t},createWidgetGroup:function(e){return"text"===e.type?groupWidgets=this.createTextWidgetGroup(e):"textarea"===e.type?groupWidgets=this.createTextareaWidgetGroup(e):"select"===e.type?groupWidgets=this.createSelectWidgetGroup(e):"check"===e.type?groupWidgets=this.createCheckWidgetGroup(e):"radio"===e.type?groupWidgets=this.createRadioWidgetGroup(e):"date"===e.type?groupWidgets=this.createDateWidgetGroup(e):"time"===e.type?groupWidgets=this.createTimeWidgetGroup(e):"spinner"===e.type?groupWidgets=this.createSpinnerWidgetGroup(e):"textparagraph"===e.type&&(groupWidgets=this.createTextParagraphWidgetGroup(e)),groupWidgets},createTextWidgetGroup:function(e){for(var t=e.controls,l=[],n="",o=0;o<t.length;o++){control=t[o];var r=this.getValues(control),a=null!=r&&r.length>0?r[0]:null,i="ebInput ebInput_longW";control.variable.readonly&&(i+=" ebInput_disabled");var s="undefined"==typeof control.variable.required?!1:control.variable.required,d="undefined"==typeof control.variable.title?"":control.variable.title;n="<td>",n+="<input type='text' class='"+i+" "+control.variable.name+"' id='"+control.variable.name+"' name='"+control.variable.name+"' value='"+(null!=a?a:"")+"' title='"+d+"' "+(s?"required":"")+">",n+="</td>",n+="<td class ='validation-notification-"+control.variable.name+"'></td>",l.push({name:control.variable.name,type:e.type,libWidget:null})}return{widgets:l,html:n}},createTextareaWidgetGroup:function(e){for(var t=e.controls,l=[],n="",o=0;o<t.length;o++){control=t[o];var r=this.getValues(control),a=null!=r&&r.length>0?r[0]:null,i="ebTextArea ebTextArea_longW";control.variable.readonly&&(i+=" ebInput_disabled");var s="undefined"==typeof control.variable.title?"":control.variable.title;n+="<td>",n+="<textarea class='"+i+" "+control.variable.name+"' id='"+control.variable.name+"' name='"+control.variable.name+"' title='"+s+"'>",n+=null!=a?a:"",n+="</textarea>",n+="</td>",l.push({name:control.variable.name,type:e.type,libWidget:null})}return{widgets:l,html:n}},createSelectWidgetGroup:function(e){for(var l=e.controls,n=[],o="",r=0;r<l.length;r++){control=l[r],control.type=e.type;var a="undefined"==typeof control.variable.title?"":control.variable.title;o+="<td class='"+control.variable.name+"' title = '"+a+"'>";var i=null,s=[];if("local"===control.initialValue.source){for(var r=0;r<control.initialValue.values.length;r++)s.push({name:control.initialValue.values[r]});s.length>0&&(i=s[0])}else if("instance"===control.initialValue.source){var d=this.getValues(control),u=null!=d&&d.length>0?d[0]:null;if(u){for(var c=u.split(","),p=0;p<c.length;p++)s.push({name:c[p]});i=s[0]}}libWidget=new t({value:i,items:s,modifiers:[{name:"smallW"}]}),o+="</td>",n.push({name:control.variable.name,type:e.type,libWidget:libWidget})}return{widgets:n,html:o}},createCheckWidgetGroup:function(e){var t=e.controls,l=[],n="";n+="<td>";for(var o=0;o<t.length;o++){control=t[o],control.type=e.type;var r=this.getValues(control),a=null!=r&&r.length>0?r[0]:null,i="ebCheckbox";control.variable.readonly&&(i+=" ebInput_disabled"),n+="<label><input type='checkbox' class='"+i+" "+control.variable.name+"' id='"+control.variable.name+"' name='"+control.variable.name+"'"+(null!=a&&1==a?" checked":"")+"/><span class='ebCheckbox-inputStatus'></span><span class='ebCheckbox-label eaNFE_automation_UI-WfForm-checkbox-label'>"+control.variable.name+"</span></label>",l.push({name:control.variable.name,type:e.type,libWidget:null})}return n+="</td>",{widgets:l,html:n}},createRadioWidgetGroup:function(e){var t=e.controls,l=[],n="";n+="<td>";for(var o=0;o<t.length;o++){control=t[o],control.type=e.type;var r=this.getValues(control),a=null!=r&&r.length>0?r[0]:null,i="ebRadioBtn";control.variable.readonly&&(i+=" ebInput_disabled"),n+="<label><input type='radio' class='"+i+" "+control.variable.name+"' id='"+control.variable.name+"' name='"+e.name+"'"+(null!=a&&1==a?" checked":"")+"/><span class='ebRadioBtn-inputStatus'></span><span class='ebRadioBtn-label eaNFE_automation_UI-WfForm-radio-label'>"+control.variable.name+"</span></label>",l.push({name:control.variable.name,type:e.type,libWidget:null})}return n+="</td>",{widgets:l,html:n}},createDateWidgetGroup:function(e){for(var t=e.controls,n=[],o="",r=0;r<t.length;r++)control=t[r],control.type=e.type,o+="<td class='"+control.variable.name+"'>",libWidget=new l({}),o+="</td>",n.push({name:control.variable.name,type:e.type,libWidget:libWidget});return{widgets:n,html:o}},createTimeWidgetGroup:function(e){for(var t=e.controls,l=[],o="",r=0;r<t.length;r++)control=t[r],control.type=e.type,o+="<td class='"+control.variable.name+"'>",libWidget=new n({}),o+="</td>",l.push({name:control.variable.name,type:e.type,libWidget:libWidget});return{widgets:l,html:o}},createSpinnerWidgetGroup:function(e){for(var t=e.controls,l=[],n="",r=0;r<t.length;r++){control=t[r],control.type=e.type;var a=this.getValues(control),i=null!=a&&a.length>0?a[0]:null;n+="<td class='"+control.variable.name+"'>",libWidget=new o({value:i}),n+="</td>",l.push({name:control.variable.name,type:e.type,libWidget:libWidget})}return{widgets:l,html:n}},createTextParagraphWidgetGroup:function(e){for(var t=e.controls,l=[],n="",o=0;o<t.length;o++){control=t[o];var r=this.getValues(control),a=null!=r&&r.length>0?r[0]:null,i="ebText";"undefined"==typeof control.variable.required?!1:control.variable.required,"undefined"==typeof control.variable.title?"":control.variable.title;n="<td colspan=2 style='padding:10px 0px 10px 0px;'>",n+="<div class='eb_scrollbar' style='width:319px; height:100px;'><h4>"+e.label+"</h4><div class='"+i+"'>"+(null!=a?a:"")+"</div></div>",n+="</td>",l.push({name:control.variable.name,type:e.type,libWidget:null})}return{widgets:l,html:n}},createVariables:function(){this.variables=new Object(null),null!=this.variableCollection&&this.variableCollection.each(function(e){this.variables[e.getAttribute("name")]={name:e.getAttribute("name"),type:e.getAttribute("type"),value:e.getAttribute("value")}}.bind(this))},validateForm:function(){var e=this.formModel.getAttribute("formInfo");if("json"!=e.format&&"html"!=e.format||"model1"!=e.modelType)throw"Invalid form format:modelType: "+e.format+":"+e.modelType+". Supported: json:model1"},getControlWidgetValue:function(e){var t=null,l=null,n=this.formElement.find("."+e.name);if("text"===e.type&&(t=n.element.value,l=n.element.required),"textarea"===e.type)t=n.element.value;else if("select"===e.type)t=e.libWidget.getValue().name;else if("check"===e.type)t=n.element.checked;else if("radio"===e.type)t=n.element.checked;else if("date"===e.type)t=e.libWidget.getValue();else if("time"===e.type){var o=e.libWidget.getValue();t=o.hours+":"+o.minutes+":"+o.seconds}else"spinner"===e.type&&(t=e.libWidget.getValue());return{value:t,required:l}},getVariables:function(){for(var e=Object.create(null),t="",l=!0,n=0;n<this.controlWidgets.length;n++){t="";var o=this.controlWidgets[n];if(e[o.name]=this.getControlWidgetValue(o),e[o.name].required&&""==e[o.name].value&&(t=o.name,l=!1),""!==t){var r=new a({label:"Required Field!",icon:"error",color:"red",showCloseButton:!0,autoDismiss:!0,autoDismissDuration:5e3});r.attachTo(this.view.getRequired(t))}}return l?e:void 0}})});