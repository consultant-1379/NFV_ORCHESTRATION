/* Copyright (c) Ericsson 2015 */

define("styles!widget/WorkflowProgressSide/workflowProgressSide.less",function(){return""}),define("text!widget/WorkflowProgressSide/workflowProgressSide.html",function(){return'<div class="eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Section">\r\n				<h2>Workflow Progress</h2>\r\n          		<div class="eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Completed">Completed:</div>\r\n          		<div class="eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Percentage"></div>\r\n          		<div class="eaWorkflowHistory-MainRegion-contentWfInstanceN-home-StatusBar"></div>\r\n          		<div class="eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-StartedName">Started: </div>\r\n          		<div class="eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Started"></div>\r\n          		        	\r\n	          	 <div class="eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-userTaskFormContent">\r\n	      			<div class="eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-UserTaskForm"></div>\r\n	      		    <div class="eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Divider2"></div>\r\n	      		    <div class="eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-UserActivity"></div>\r\n				</div>\r\n				<div class="eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-BottomDivider"></div>\r\n			</div> '}),define("widget/WorkflowProgressSide/WorkflowProgressSideView",["jscore/core","text!./workflowProgressSide.html","styles!./workflowProgressSide.less"],function(e,t,n){return e.View.extend({getTemplate:function(){return t},getStyle:function(){return n},getBreadcrumb:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-Breadcrumb")},getWfInstanceNContent:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home")},getContentDiagram:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-contentWfInstanceN-contentDiagram")},getBackButton:function(){return this.getElement().find(".eaNFE_automation_UI-WfDetails-buttonBack")},getWfInstanceNProgress:function(){return this.getElement().find(".eaNFE_automation_UI-WfDetails-progress")},getBarCell:function(){return this.getElement().find(".eaWorkflowHistory-MainRegion-contentWfInstanceN-home-StatusBar")},getTitle1:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-Title1")},getTitle2:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-Title2")},getPercentage:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Percentage")},getStartTime:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Started")},getBarPercentageCell:function(){return this.getElement().find(".eaNFE_automation_UI-WfBarCell-contentTable-BarCell")},getUserTaskFormContent:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-userTaskFormContent")},getUserActivityContent:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-UserActivity")},getRefreshButton:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-contentWfInstanceN-buttonRefresh")},addRefreshClickHandler:function(e){this.getElement().find(".eaNFE_automation_UI-WfDetails-buttonRefresh").addEventHandler("click",e)},getContentDetails:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-contentWfInstanceN-contentDetails")}})}),define("widget/WorkflowProgressSide/WorkflowProgressSide",["jscore/core","./WorkflowProgressSideView","jscore/ext/mvp","widget/WfDetails/WfDetails","widget/WfBarCell/WfBarCell","3pps/wfs/WfInstanceClient","widget/WfUsertasks/TaskFormOnDrilldown/TaskFormOnDrilldown"],function(e,t,n,i,o,s,r){return e.Widget.extend({View:t,onViewReady:function(){var e=window.location.hash,t=e.substring(e.indexOf("/")+1).split("/");this.params={workflowDefinitionId:t[0],workflowInstanceId:t[2],workflowName:t[1],startTime:t[3]},this.options.regionEventBus.eventBus.subscribe("updatePercentage",function(e){this.view.getPercentage().setText(e),void 0===e||null===e?this.view.getPercentage().setText("N/A"):this.view.getPercentage().setText(e+"%"),0==this.percentComplete&&this.view.getBarPercentageCell().setStyle("width","0px"),5>e&&e>0?this.view.getBarPercentageCell().setStyle("width","5px"):this.view.getBarPercentageCell().setStyle("width",e+"px")}.bind(this)),this.options.regionEventBus.eventBus.subscribe("userTask",function(e,t,n,i){this.taskForm||(this.taskForm=new r({wfUsertaskModel:e,minHeight:n,taskHandledCallback:t}),this.taskForm.addEventHandler("toggleContentDrilldown",i)),this.taskForm.attachTo(this.view.getUserTaskFormContent())}.bind(this)),this.options.regionEventBus.eventBus.subscribe("updateTimestamp",function(e){this.view.getStartTime().setText(e)}.bind(this));var n=this.params.startTime;this.view.getStartTime().setText(n),this.activeWorkflowDefinitionId=this.params.workflowDefinitionId,this.activeWorkflowInstanceId=this.params.workflowInstanceId,this.showingChild=!1,this.wfBarCell=new o({regionEventBus:this.regionEventBus}),this.wfBarCell.attachTo(this.view.getBarCell()),this.options.regionEventBus.eventBus.subscribe("hideForm",function(){null!=this.taskForm&&(this.taskForm.detach(),this.taskForm=null)}.bind(this))},hideUserActivityContent:function(){this.view.getUserActivityContent2()||this.view.getUserActivityContent2().setStyle("display","block"),this.view.getUserActivityContent2()?this.view.getUserActivityContent2().setStyle("display","none"):this.view.getUserActivityContent2().setStyle("display","block")}})});