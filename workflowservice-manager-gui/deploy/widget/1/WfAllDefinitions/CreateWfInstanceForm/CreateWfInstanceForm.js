/* Copyright (c) Ericsson 2015 */

define("styles!widget/WfAllDefinitions/CreateWfInstanceForm/CreateWfInstanceForm.less",function(){return".eaNFE_automation_UI-WfAllDefinitions-CreateWfInstanceForm {\n  padding-right: 10px;\n  width: 100%;\n}\n.eaNFE_automation_UI-WfAllDefinitions-CreateWfInstanceForm-Buttons {\n  padding-top: 10px;\n  background-color: #f2f2f2;\n  padding: 6px 0;\n  padding-left: 120px;\n  width: 245px;\n}\n.eaNFE_automation_UI-WfAllDefinitions-CreateWfInstanceForm-BottomDivider {\n  padding-top: 5px;\n}\n"}),define("template!widget/WfAllDefinitions/CreateWfInstanceForm/CreateWfInstanceForm.html",["jscore/handlebars/handlebars"],function(t){return t.template(function(t,e,n,i,o){n=n||t.helpers;var a,r,s="",l="function",f=n.helperMissing,c=void 0,u=this.escapeExpression;return s+='<div class="eaNFE_automation_UI-WfAllDefinitions-CreateWfInstanceForm">\r\n 	<div class="eaNFE_automation_UI-WfAllDefinitions-CreateWfInstanceForm-Panel">\r\n	    <div class="ebLayout-SectionSubheading">\r\n    	    <h3>Create Workflow Instance: ',r=n.workflowName,a=r||e.workflowName,typeof a===l?a=a.call(e,{hash:{}}):a===c&&(a=f.call(e,"workflowName",{hash:{}})),s+=u(a)+'</h3>\r\n    	</div>\r\n    	<div class="eaNFE_automation_UI-WfAllDefinitions-CreateWfInstanceForm-FormContent"></div>\r\n 	</div>\r\n 	<div class="eaNFE_automation_UI-WfAllDefinitions-CreateWfInstanceForm-Buttons">\r\n        <button type="button" class="ebBtn ebBtn_color_paleBlue eaNFE_automation_UI-WfAllDefinitions-CreateWfInstanceForm-Buttons-buttonSubmit">Submit</button>\r\n        <button type="button" class="ebBtn ebBtn_wMargin eaNFE_automation_UI-WfAllDefinitions-CreateWfInstanceForm-Buttons-buttonCancel">Cancel</button>\r\n 	</div>\r\n 	</div>'})}),define("widget/WfAllDefinitions/CreateWfInstanceForm/CreateWfInstanceFormView",["jscore/core","template!./CreateWfInstanceForm.html","styles!./CreateWfInstanceForm.less"],function(t,e,n){return t.View.extend({getTemplate:function(){return e(this.options)},getStyle:function(){return n},getFormContent:function(){return this.getElement().find(".eaNFE_automation_UI-WfAllDefinitions-CreateWfInstanceForm-FormContent")},getSubmitButton:function(){return this.getElement().find(".eaNFE_automation_UI-WfAllDefinitions-CreateWfInstanceForm-Buttons-buttonSubmit")},getCancelButton:function(){return this.getElement().find(".eaNFE_automation_UI-WfAllDefinitions-CreateWfInstanceForm-Buttons-buttonCancel")}})}),define("widget/WfAllDefinitions/CreateWfInstanceForm/CreateWfInstanceForm",["jscore/core","3pps/wfs/WfDefinitionClient","3pps/wfs/WfInstanceClient","../../WfForm/WfForm","../../ErrorDialog/ErrorDialog","./CreateWfInstanceFormView"],function(t,e,n,i,o,a){return t.Widget.extend({view:function(){var t=this.options.wfDefinitionModel.name;return new a({workflowName:t})},onViewReady:function(){this.createHandledCallback=this.options.createHandledCallback,this.wfDefinitionId=this.options.wfDefinitionModel.id,e.getStartFormModelById({wfDefinitionId:this.wfDefinitionId,success:function(t){var e=this.view.getCancelButton();e.addEventHandler("click",function(){this.handleCancel()}.bind(this));var n=this.view.getSubmitButton();if(n.addEventHandler("click",function(){this.handleSubmit(t)}.bind(this)),null!=t){null!=t.getAttribute("cancelText")&&e.setText(t.getAttribute("cancelText")),null!=t.getAttribute("submitText")&&n.setText(t.getAttribute("submitText"));try{this.form&&this.form.detach(),this.form=new i({formModel:t,variableCollection:null}),this.form.attachTo(this.view.getFormContent())}catch(o){this.handleError("Unable to build form for "+this.wfDefinitionId,[o])}}this.options.minHeight&&this.getElement().setStyle("min-height","300px;")}.bind(this),error:function(t){this.handleError("Unable to retrieve form for "+this.wfDefinitionId,[t])}.bind(this)})},handleSubmit:function(t){var e=Object.create(null),i="";n.getTORUserId({success:function(t){i=t;var o=Object.create(null);o.value=i,o.required=!0,this.form&&(e=this.form.getVariables()),e["tor-user-id"]=o,null!=e&&n.startInstanceById({wfDefinitionId:this.wfDefinitionId,variables:e,success:function(){this.createHandledCallback(!0)}.bind(this),error:function(t){this.handleError("Unable to start workflow instance for "+this.wfDefinitionId,[t])}.bind(this)})}.bind(this)})},handleCancel:function(){this.createHandledCallback(!1)},handleError:function(t,e){var n=" ";if(null!=e&&e.length>0)for(var i=0;i<e.length;i++)n+=e[i]+" ";new o({title:t,message:n}),this.createHandledCallback(!1)}})});