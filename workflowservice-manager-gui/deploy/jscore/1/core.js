/* Copyright (c) Ericsson 2014 */

define("jscore/ext/utils/base/trigger",[],function(){"use strict";function e(e,r,o){var a,s;o=o||{};for(var c in n)o.hasOwnProperty(c)||(o[c]=n[c]);if(document.createEvent)s=t[r]||"CustomEvent",a=document.createEvent(s),i[s](e,r,a,o),e.dispatchEvent(a);else{a=document.createEventObject();for(var u in o)a[u]=o[u];e.fireEvent("on"+r,a)}}var t={load:"HTMLEvents",unload:"HTMLEvents",abort:"HTMLEvents",error:"HTMLEvents",select:"HTMLEvents",change:"HTMLEvents",submit:"HTMLEvents",reset:"HTMLEvents",focus:"HTMLEvents",blur:"HTMLEvents",resize:"HTMLEvents",scroll:"HTMLEvents",input:"HTMLEvents",keyup:"KeyboardEvent",keydown:"KeyboardEvent",click:"MouseEvents",dblclick:"MouseEvents",mousedown:"MouseEvents",mouseup:"MouseEvents",mouseover:"MouseEvents",mousemove:"MouseEvents",mouseout:"MouseEvents",contextmenu:"MouseEvents"},n={clientX:0,clientY:0,button:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,bubbles:!0,cancelable:!0,view:document.defaultView,key:"",location:0,modifiers:"",repeat:0,locale:""},i={HTMLEvents:function(e,t,n,i){return n.initEvent(t,i.bubbles,i.cancelable)},KeyboardEvent:function(e,t,n,i){var r,o,a="key"in i?i.key:"",s="location"in i?i.location:0;return n.initKeyboardEvent?(!1 in i?(o=[],i.ctrlKey&&o.push("Ctrl"),i.altKey&&o.push("Alt"),i.ctrlKey&&i.altKey&&o.push("AltGraph"),i.shiftKey&&o.push("Shift"),i.metaKey&&o.push("Meta"),o=o.join(" ")):o=i.modifiers,n.initKeyboardEvent(t,i.bubbles,i.cancelable,i.view,a,s,o,i.repeat,i.locale)):(r="charCode"in i?i.charCode:a.charCodeAt(0)||0,n.initKeyEvent(t,i.bubbles,i.cancelable,i.view,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,r,a))},MouseEvents:function(e,t,n,i){var r,o,a="screenX"in i?i.screenX:i.clientX,s="screenY"in i?i.screenY:i.clientY;return r="detail"in i?i.detail:"dblclick"===t?2:1,"contextmenu"===t&&(o=o=i.button||2),n.initMouseEvent(t,i.bubbles,i.cancelable,i.view,r,a,s,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,o,e)},CustomEvent:function(e,t,n,i){return n.initCustomEvent(t,i.bubbles,i.cancelable,i.detail)}};return e}),define("jscore/ext/validationPatterns",[],{alphanumeric:{title:"Text with only alpha numeric chars",pattern:"^[a-zA-Z0-9\\s]+$"},integer:{title:"Should be an integer",pattern:"^-?[0-9]+$"},integerPositive:{title:"Should be a positive integer",pattern:"^\\+?[0-9]+$"},ipv4:{title:"This should be a valid IPv4 Address",pattern:"((^|\\.)((25[0-5])|(2[0-4]\\d)|(1\\d\\d)|([1-9]?\\d))){4}$"},ipv6:{title:"This should be a valid IPv6 Address",pattern:"((^\\s*((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))\\s*$)|(^\\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(%.+)?\\s*$))|(^\\s*((?=.{1,255}$)(?=.*[A-Za-z].*)[0-9A-Za-z](?:(?:[0-9A-Za-z]|\\b-){0,61}[0-9A-Za-z])?(?:\\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|\\b-){0,61}[0-9A-Za-z])?)*)\\s*$)"},number:{title:"Should be an integer or a decimal",pattern:"^[-\\+]?[0-9]+([\\.,][0-9][0-9]*)?$"}}),define("jscore/ext/dom",["jscore/base/jquery","jscore/ext/validationPatterns","jscore/ext/utils/base/trigger"],function(e,t,n){"use strict";function i(){return e.parseHTML.apply(this,arguments)[0]}function r(t){var n=e(t),i=n.data("element");return i||(i=a.wrap(t),n.data("element",i)),i}function o(t){var n=e(t._getHTMLElement()),i=n.attr("class");if(void 0!==i&&(i=i.split(" "),!t._modifiersInitialised)){t._modifiers={};for(var r=new RegExp("(?:([a-zA-Z0-9-]+))(?:_([a-zA-Z0-9]+))?(?:_[a-zA-Z0-9]+)?"),o=0;o<i.length;o++){var a=i[o].match(r);a&&(0===o&&(t._modifierPrefix=a[1]),a[2]&&(t._modifiers[a[1]+"_"+a[2]]=a[0]))}t._modifiersInitialised=!0}}function a(e){this._setHTMLElement(document.createElement(e||"div"))}a.prototype={find:function(e){return s.find(e,this)},getValue:function(){return s.getValue(this)},setValue:function(e){s.setValue(this,e)},append:function(e){s.append(this,e)},remove:function(){s.remove(this)},detach:function(){s.detach(this)},children:function(){return s.children(this)},addEventHandler:function(e,t,n){return s.addEventHandler(this,e,t,n)},removeEventHandler:function(e){s.removeEventHandler(e)},trigger:function(e,t){s.trigger(this,e,t)},getText:function(){return s.getText(this)},setText:function(e){s.setText(this,e)},getAttribute:function(e){return s.getAttribute(this,e)},setAttribute:function(e,t){s.setAttribute(this,e,t)},removeAttribute:function(e){s.removeAttribute(this,e)},getProperty:function(e){return s.getProperty(this,e)},setProperty:function(e,t){s.setProperty(this,e,t)},getStyle:function(e){return s.getStyle(this,e)},setStyle:function(e,t){s.setStyle(this,e,t)},removeStyle:function(e){s.removeStyle(this,e)},setModifier:function(e,t,n){s.setModifier(this,e,t,n)},hasModifier:function(e,t,n){return s.hasModifier(this,e,t,n)},removeModifier:function(e,t){s.removeModifier(this,e,t)},contains:function(e){return s.contains(this,e)},getPosition:function(){return s.getPosition(this)},focus:function(){s.focus(this)},setValidator:function(e,t){s.setValidator(this,e,t)},_getHTMLElement:function(){return this.element},_setHTMLElement:function(e){this.element=e,this._modifiersInitialised=!1,o(this)}},a.parse=function(e){var t=new a;return t._setHTMLElement(i(e)),t},a.wrap=function(e){var t=new a;return t._setHTMLElement(e),t};var s={Element:a,find:function(t,n){if(n){var i=e(n._getHTMLElement()).find(t)[0];return void 0!==i?r(i):void 0}},setValue:function(t,n){e(t._getHTMLElement()).val(null!==n&&void 0!==n?n:"")},getValue:function(t){return e(t._getHTMLElement()).val()},append:function(t,n){e(t._getHTMLElement()).append(n._getHTMLElement())},remove:function(t){e(t._getHTMLElement()).remove()},detach:function(t){e(t._getHTMLElement()).detach()},children:function(t){for(var n=e(t._getHTMLElement()).children(),i=[],o=0;o<n.length;o++)i.push(r(n[o]));return i},getText:function(t){return e(t._getHTMLElement()).text()},setText:function(t,n){e(t._getHTMLElement()).text(null!==n&&void 0!==n?n:"")},getAttribute:function(t,n){return e(t._getHTMLElement()).attr(n)},setAttribute:function(t,n,i){e(t._getHTMLElement()).attr(n,i)},removeAttribute:function(t,n){e(t._getHTMLElement()).removeAttr(n)},getProperty:function(t,n){return e(t._getHTMLElement()).prop(n)},setProperty:function(t,n,i){e(t._getHTMLElement()).prop(n,i)},addEventHandler:function(e,t,n,i){i||(i=this);var r=function(e){function t(){e.preventDefault()}function r(){e.stopPropagation()}var o={originalEvent:e,preventDefault:t,stopPropagation:r};n.call(i,o)},o=e._getHTMLElement(),a=t.split(" ");return a.forEach(function(e){o.addEventListener(e,r)}),{destroy:function(){a.forEach(function(e){o.removeEventListener(e,r)})}}},removeEventHandler:function(e){e.destroy()},trigger:function(e,t,i){n(e._getHTMLElement(),t,i)},getStyle:function(t,n){return e(t._getHTMLElement()).css(n)},setStyle:function(t,n,i){void 0!==i?e(t._getHTMLElement()).css(n,i):e(t._getHTMLElement()).css(n)},removeStyle:function(t,n){e(t._getHTMLElement()).css(n,"")},setModifier:function(t,n,i,r){if(n&&n.indexOf(" ")>=0||i&&i.indexOf(" ")>=0)throw new Error("Key/Value in modifier should not contain whitespace");void 0===t._modifiers&&(t._modifiers={});var a=e(t._getHTMLElement());if(o(t),void 0===t._modifierPrefix&&!r)throw new Error("Element does not have a class.");var s=(r&&""!==r?r:t._modifierPrefix)+"_"+n,c=s;i&&""!==i&&(c+="_"+i),t._modifiers[s]&&a.removeClass(t._modifiers[s]),a.addClass(c),t._modifiers[s]=c},hasModifier:function(e,t,n,i){var r=(i&&""!==i?i:e._modifierPrefix)+"_"+t;return e._modifiers&&void 0!==e._modifiers[r]&&(!n||void 0!==n&&e._modifiers[r]===r+"_"+n)},removeModifier:function(t,n,i){var r=e(t._getHTMLElement()),o=(i&&""!==i?i:t._modifierPrefix)+"_"+n;t._modifiers&&t._modifiers[o]&&(r.removeClass(t._modifiers[o]),delete t._modifiers[o])},contains:function(e,t){return e._getHTMLElement().contains(t._getHTMLElement())},getPosition:function(e){var t=e._getHTMLElement().getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left}},focus:function(e){e._getHTMLElement().focus()},setValidator:function(e,n,i){if("input"!==e._getHTMLElement().tagName.toLowerCase())throw new Error("Element must be an input.");var r,o=["email","url","password"],a="text";if("string"==typeof n||n instanceof String)if(-1!==o.indexOf(n))a=n;else{if(!t[n])throw new Error("Type '"+n+"' not supported.");r=t[n]}else"object"==typeof n&&n.pattern&&(r=n);r&&(void 0===e.getAttribute("title")&&r.title&&e.setAttribute("title",r.title),e._getHTMLElement().setAttribute("pattern",r.pattern));var s=e.getAttribute("type");(!s||s&&"password"!==s)&&e.setAttribute("type",a);var c=void 0!==i?i:"true";e.setProperty("required",c)}};return s}),define("jscore/core",["./interfaces","./ext/dom"],function(e,t){"use strict";function n(){return void 0!==this.View&&(this.view=new this.View({presenter:this})),void 0!==this.view?("function"==typeof this.view&&(this.view=this.view()),this.view.render(),this.view.element):new h}function i(e,t){if(t&&void 0===t.constructor.prototype.styles){var n=document.createElement("style");n.textContent=e,t.constructor.prototype.styles=n,c.push(n),document.head.appendChild(n)}}function r(e,t){for(var n=this._getChannel(e),i=n.length,r=0;i>r;r++)if(n[r].id===t){n=n.splice(r,1);break}}function o(){this._channels=[]}function a(e){this.options=e||{},this.init.apply(this,arguments)}var s={},c=[],u={},l={},d={},f=!1;!function(){for(var e=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var n=(new Date).getTime(),i=Math.max(0,16-(n-e)),r=window.setTimeout(function(){t(n+i)},i);return e=n+i,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),s.setRootElement=n,s.addStyles=i,s.removeChannel=r;var h=t.Element,m={addEventHandler:function(e,t){var n=v(),i=function(e){var n={};e&&(n.originalEvent=e),f&&t(n)};return u[n]={id:n,eventName:e,callback:i},window.addEventListener(e,i,!1),n},removeEventHandler:function(e){var t=u[e];void 0!==t&&(window.removeEventListener(t.eventName,t.callback,!1),delete u[e])},setInterval:function(e,t){var n=v(),i=function(){f&&e()};return l[n]=setInterval(i,t),{stop:function(){clearInterval(l[n]),delete l[n]}}},eachFrame:function(e){var t=v(),n=!1,i=function(){f&&e(),n||(d[t]=requestAnimationFrame(i))};return d[t]=requestAnimationFrame(i),{stop:function(){cancelAnimationFrame(d[t]),delete d[t],n=!0}}},removeAllEventHandlers:function(){for(var e in u)m.removeEventHandler(e)},removeAllIntervals:function(){for(var e in l)clearInterval(l[e]);l={}},removeAllEachFrames:function(){for(var e in d)cancelAnimationFrame(d[e]);d={}},trigger:function(e,t){var n=/^([^:]+)(?::(.*))?/,i=e.match(n);if(i){var r=i[1],o=i[2];if(o)u[o].callback(t);else if(r)for(var a in u)u[a].eventName===r&&u[a].callback(t)}},getProperty:function(e){return window[e]},showPrintDialog:function(){window.print()}},v=e._private.guidGenerator;o.prototype={_hasChannel:function(e){return this._channels.hasOwnProperty(e)},_addChannel:function(e){this._channels[e]=[]},_getChannel:function(e){return this._channels[e]},subscribe:function(e,t,n){this._hasChannel(e)||this._addChannel(e),n=n?n:this;var i={id:v(),channel:e,fn:t,context:n};return this._getChannel(e).push(i),i.id},publish:function(e){if(this._hasChannel(e))for(var t=this._getChannel(e),n=Array.prototype.slice.call(arguments,1),i=t.length,r=0;i>r;r++)t[r].fn.apply(t[r].context,n)},unsubscribe:function(e,t){t?this._hasChannel(e)&&r.call(this,e,t):(t=e,Object.keys(this._channels).forEach(function(e){r.call(this,e,t)},this))}};var p=e.AppContext.extend({destroyAll:function(){var e=this._components;Object.keys(e).forEach(function(t){e[t].stop()})}}),g=e.App.extend({createContext:function(){var e=new p;return e.eventBus=new o,e},_addToContainer:function(e){var t;t=e instanceof HTMLElement?h.wrap(e):e,this._container=t,this.attach()},_removeFromContainer:function(){this.detach(),delete this._container,delete this.element},_createElement:function(){this.element=n.apply(this,arguments)},onAttach:function(){},attach:function(){var e=this.element;if(void 0!==e&&e._getHTMLElement().parentNode!==this._container._getHTMLElement()){if(this.constructor.prototype.counter++,1===this.constructor.prototype.counter){var t=document.head;c.forEach(function(e){t.appendChild(e)})}this._container.append(e),this.onAttach(),f=!0,m.trigger("resize"),m.trigger("hashchange")}},attachTo:function(e){var t=this.element;e=e instanceof HTMLElement?e:e._getHTMLElement(),(void 0===t||t._getHTMLElement().parentNode!==e)&&(this.detach(),this._addToContainer(e),this.onAttach(),f=!0,m.trigger("resize"),m.trigger("hashchange"))},detach:function(){var e=this.element;void 0!==e&&e._getHTMLElement().parentNode===this._container._getHTMLElement()&&(this.constructor.prototype.counter--,e.detach(),0===this.constructor.prototype.counter&&c.forEach(function(e){e.parentNode.removeChild(e)}),f=!1)},getEventBus:function(){return this.getContext().eventBus},getElement:function(){return this.element},stop:function(){e.App.prototype.stop.apply(this,arguments),f=!1,m.removeAllEventHandlers(),m.removeAllIntervals(),m.removeAllEachFrames()}});a.prototype={init:function(){},getTemplate:function(){},getStyle:function(){return""},render:function(){var e=this.getStyle();""!==e.trim()&&i(e,this);var t=this.getTemplate();this.element="string"==typeof t?h.parse(t):t},getElement:function(){return this.element}},a.extend=e.extend;var E=e.UIComponent.extend({_listenForDOMAttach:function(){if(this.onDOMAttach){var e=function(){document.body.contains(this.getElement()._getHTMLElement())?this.onDOMAttach():requestAnimationFrame(e)}.bind(this);requestAnimationFrame(e)}},start:function(e){if(!this._parent){this._createElement(),e.append(this.getElement()),this._listenForDOMAttach(),this._parent=e,this.onStart();var t=this.context;t&&t._components&&(t._components[this.uid]=this)}},onStart:function(){},stop:function(){if(this._parent){var e=this.getContext();if(void 0!==e){var t=e._components;void 0!==t&&void 0!==t[this.uid]&&delete t[this.uid]}this.destroy(),delete this._parent,this.onStop()}},onStop:function(){},attach:function(){var e=this.element,t=this._parent;void 0!==e&&void 0!==t&&e._getHTMLElement().parentNode!==t._getHTMLElement()&&t.append(e)},detach:function(){var e=this.element,t=this._parent;void 0!==e&&void 0!==t&&e._getHTMLElement().parentNode===t._getHTMLElement()&&e.detach()},_createElement:function(){this.element=n.apply(this,arguments)},getEventBus:function(){return this.getContext().eventBus},destroy:function(){this.getElement().remove()},setContext:function(e){e._components[this.uid]=this,this.context=e},getContext:function(){return this.context}}),_=e.UIComponent.extend({_listenForDOMAttach:function(){if(this.onDOMAttach){var e=function(){document.body.contains(this.getElement()._getHTMLElement())?this.onDOMAttach():requestAnimationFrame(e)}.bind(this);requestAnimationFrame(e)}},_afterInit:function(){this._createElement(),this.onViewReady.apply(this,arguments)},onViewReady:function(){},onAttach:function(){},attachTo:function(e){this._parent&&this.element._getHTMLElement().parentNode===e._getHTMLElement()||(this.detach(),this._parent=e,this.attach())},attach:function(){var e=this.element,t=this._parent;void 0!==e&&void 0!==t&&e._getHTMLElement().parentNode!==t._getHTMLElement()&&(t.append(e),this.onAttach(),this._listenForDOMAttach())},detach:function(){var e=this.element,t=this._parent;void 0!==e&&void 0!==t&&e._getHTMLElement().parentNode===t._getHTMLElement()&&e.detach()},addEventHandler:function(){return void 0===this.eventBus&&(this.eventBus=new o),this.eventBus.subscribe.apply(this.eventBus,arguments)},removeEventHandler:function(){this.eventBus&&this.eventBus.unsubscribe.apply(this.eventBus,arguments)},trigger:function(){this.eventBus&&this.eventBus.publish.apply(this.eventBus,arguments)},_createElement:function(){this.element=n.apply(this,arguments)},destroy:function(){this.onDestroy(),delete this.eventBus,this.getElement().remove()},onDestroy:function(){}}),y=function(e){this._nativeXHR=e};return y.prototype={abort:function(){this._nativeXHR.abort.call(this._nativeXHR)},getReadyState:function(){return this._nativeXHR.readyState},getStatus:function(){return this._nativeXHR.status},getResponseJSON:function(){return JSON.parse(this._nativeXHR.responseText)},getResponseText:function(){return this._nativeXHR.responseText},getStatusText:function(){return this._nativeXHR.statusText}},{App:g,AppContext:p,EventBus:o,Region:E,Widget:_,Window:m,View:a,Element:h,XHR:y,extend:e.extend,_private:s,version:"1.3.3"}});