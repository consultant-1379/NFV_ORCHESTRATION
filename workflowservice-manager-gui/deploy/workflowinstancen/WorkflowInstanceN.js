/* Copyright (c) Ericsson 2015 */
define('text',{load:function(e){throw new Error('Dynamic load not allowed: '+e)}});define('styles',{load:function(e){throw new Error('Dynamic load not allowed: '+e)}});define('template',{load:function(e){throw new Error('Dynamic load not allowed: '+e)}});define('json',{load:function(e){throw new Error('Dynamic load not allowed: '+e)}});
define("styles!workflowinstancen/region/WorkflowInstanceNRegion/workflowInstanceNRegion.less",function(){return".eaWorkflowInstanceNRegion-MainRegion-Panel {\n  display: inline-block;\n}\n.eaWorkflowInstanceNRegion-MainRegion-Panel-iconHolder {\n  margin-top: 1.2rem;\n  padding: 0.8rem 0;\n  background-color: #E6E6E6;\n  width: 1565px;\n  border-radius: 3px;\n  padding-left: 10px;\n}\n.eaWorkflowInstanceNRegion-MainRegion-Panel-DeleteInstance {\n  display: inline-block;\n  padding-right: 5px;\n  cursor: pointer;\n  cursor: hand;\n}\n.eaWorkflowInstanceNRegion-MainRegion-Panel-DuplicateInstance {\n  display: inline-block;\n  cursor: pointer;\n  cursor: hand;\n}\n.eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-contentDiagram {\n  width: 100%;\n}\n.eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-comments {\n  margin: 10px 0px 0px 0px;\n  width: 550px;\n}\n.eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-Buttons {\n  padding: 3px;\n}\n.eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-home-Section {\n  position: absolute;\n  width: 300px;\n}\n.eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-home-Section-Buttons {\n  padding: 3px;\n}\n.eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-home-Section-Buttons-buttonBack {\n  float: left;\n}\n.eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-home-Completed {\n  padding-top: 5px;\n}\n.eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-home-Percentage {\n  padding-top: 20px;\n  padding-bottom: 20px;\n  font-size: 5rem;\n  color: #89ba17;\n}\n.eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-home-Started {\n  padding-top: 20px;\n  padding-bottom: 5px;\n  display: inline-block;\n}\n.eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-home-StartedName {\n  padding-top: 20px;\n  padding-bottom: 5px;\n  display: inline-block;\n}\n.eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-home-Divider {\n  border-bottom: 1px solid #666666;\n  width: 1565px;\n  padding-top: 5px;\n  padding-bottom: 5px;\n}\n.eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-home-Divider2 {\n  border-bottom: #cccccc solid 1px;\n  width: 300px;\n  padding-bottom: 15px;\n}\n.eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-bottomDivider {\n  width: 100%;\n  border-bottom: 1px solid #666666;\n}\n.elLayouts-TopSection {\n  margin-left: 0px !important;\n  margin-right: 70px !important;\n}\n.elLayouts-Wrapper {\n  overflow: none !important;\n}\n.ebBreadcrumbs-link-new {\n  font-size: 14px;\n  margin: 0;\n  padding: 6px;\n  display: inline-block;\n  vertical-align: middle;\n  color: #333333;\n  text-decoration: none;\n}\n.ebBreadcrumbs-link-new:hover {\n  box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.2);\n  border-radius: 10px;\n  box-sizing: border-box;\n  cursor: pointer;\n  color: #333333;\n  text-decoration: none;\n}\n.ebBreadcrumbs-link-current {\n  color: #adadad;\n  pointer-events: none;\n  cursor: default;\n  font-size: 14px;\n  margin: 0;\n  padding: 6px;\n  display: inline-block;\n  vertical-align: middle;\n  text-decoration: none;\n}\n"}),define("text!workflowinstancen/region/WorkflowInstanceNRegion/workflowInstanceNRegion.html",function(){return'<div class="eaWorkflowInstanceNRegion-MainRegion">\r\n	<div class="eaWorkflowInstanceNRegion-MainRegion-Panel"></div>\r\n		<div class="eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-contentDiagram">\r\n			<div class="eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-contentDetails"></div>\r\n			<div class="eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-home"></div>\r\n			<div class="eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-bottomDivider"></div>\r\n		</div>\r\n</div>\r\n'}),define("workflowinstancen/region/WorkflowInstanceNRegion/WorkflowInstanceNRegionView",["jscore/core","text!./workflowInstanceNRegion.html","styles!./workflowInstanceNRegion.less"],function(n,e,t){return n.View.extend({getTemplate:function(){return e},getStyle:function(){return t},getBreadcrumb:function(){return this.getElement().find(".eaWorkflowInstanceNRegion-MainRegion-Breadcrumb")},getWfInstanceNContent:function(){return this.getElement().find(".eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-home")},getContentDiagram:function(){return this.getElement().find(".eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-home")},getBackButton:function(){return this.getElement().find(".eaNFE_automation_UI-WfDetails-buttonBack")},getWfInstanceNProgress:function(){return this.getElement().find(".eaNFE_automation_UI-WfDetails-progress")},getBarPercentageCell:function(){return this.getElement().find(".eaNFE_automation_UI-WfBarCell-contentTable-BarCell")},getRefreshButton:function(){return this.getElement().find(".eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-buttonRefresh")},addRefreshClickHandler:function(n){this.getElement().find(".eaNFE_automation_UI-WfDetails-buttonRefresh").addEventHandler("click",n)},getContentDetails:function(){return this.getElement().find(".eaWorkflowInstanceNRegion-MainRegion-contentWfInstanceN-contentDetails")},getTableCrumbHolder:function(){return this.getElement().find(".eaDrilldown-TableCrumbs-crumbText")}})}),define("workflowinstancen/region/WorkflowInstanceNRegion/WorkflowInstanceNRegion",["jscore/core","jscore/ext/mvp","./WorkflowInstanceNRegionView","3pps/wfs/WfInstanceClient","3pps/wfs/WfCountsClient","widget/WfUsertasks/TaskFormOnDrilldown/TaskFormOnDrilldown","widget/WfDetails/WfDetails","widget/WfDiagram/WfDiagram","widget/WfProgress/WfProgressModel","jscore/ext/locationController"],function(n,e,t,o,i,a,s,r,l,c){return n.Region.extend({View:t,onStart:function(n){this.updateURLParams(),this.showDiagram(this.params)},onAttach:function(n){this.updateURLParams(),this.showDiagram(this.params)},init:function(){this.updateURLParams()},updateURLParams:function(){var n=window.location.hash,e=n.substring(n.indexOf("/")+1).split("/");this.params={id:e[0],name:e[1],shortWorkflowInstanceId:e[2],startTime:e[3],workflowVersion:e[4]}},taskHandledCallback:function(n){this.options.regionEventBus.eventBus.publish("hideForm","hideForm"),1==n&&setTimeout(function(){this.options.regionEventBus.eventBus.publish("something-changed","usertasks")}.bind(this),2e3);var e=new c,t="workflowsinstances/"+this.params.id+"/"+this.params.name;e.setLocation(t,!1),e.start()},refresh:function(){this.options.regionEventBus.eventBus.publish("hideForm","hideForm"),this.redrawDiagram({id:this.activeWorkflowDefinitionId,shortWorkflowInstanceId:this.activeWorkflowInstanceId,name:this.workflowName})},buildOverlays:function(n,e){var t=[],o=[];for(var i in n){var a=n[i];if(a&&null!=a&&""!==a){t.push({nodeId:i,style:"highlight-"+a});var s=e[i];s&&s>0&&(s>1||1==s&&"Started"===a)&&o.push({nodeId:i,count:s})}}return{highlights:t,countBadges:o}},addCalledWorkflows:function(){this.view.getWfInstanceNProgress().element.innerHTML="";var e;i.getAncestry({processInstanceId:this.activeWorkflowInstanceId,success:function(t){var o="<table><tr>";t.each(function(n){this.activeWorkflowInstanceId==n.getAttribute("id")?(o+="<td class='eaWorkflowInstanceN-MainRegion-contentWfInstanceN-progress'>",o+="<a href='javascript:void(0)' class='ebBreadcrumbs-link-current' title='"+n.getAttribute("workflowDefinitionName").replace("\r\n"," ")+"' onclick=\"prgdiagRenderCallActProgress('"+n.getAttribute("id")+"','"+n.getAttribute("workflowDefinitionId")+"','"+n.getAttribute("workflowDefinitionName").replace("\r\n"," ")+"')\">",o+=n.getAttribute("workflowDefinitionName"),o+="</a>",o+="</td>",o+="<td class='eaWorkflowInstanceN-MainRegion-contentWfInstanceN-progress-icon'></td>"):(o+="<td class='eaWorkflowInstanceN-MainRegion-contentWfInstanceN-progress'>",o+="<a href='javascript:void(0)' class='ebBreadcrumbs-link-new' title='"+n.getAttribute("workflowDefinitionName").replace("\r\n"," ")+"' onclick=\"prgdiagRenderCallActProgress('"+n.getAttribute("id")+"','"+n.getAttribute("workflowDefinitionId")+"','"+n.getAttribute("workflowDefinitionName").replace("\r\n"," ")+"')\">",o+=n.getAttribute("workflowDefinitionName"),o+="</a>",o+="</td>",o+="<td class='eaWorkflowInstanceN-MainRegion-contentWfInstanceN-progress-icon'></td>")}.bind(this)),0==this.calledWorkflows.length&&(o=o.substring(0,o.length-81));for(var i=0;i<this.calledWorkflows.length;i++){var a=this.calledWorkflows[i];o+="<td class='eaWorkflowInstanceN-MainRegion-contentWfInstanceN-progress'>",o+="<a href='javascript:void(0)' class='ebBreadcrumbs-link-new' title='"+a.activityName.replace("\r\n"," ")+"' onclick=\"prgdiagRenderCallActProgress('"+a.childExecutionId+"','"+a.childDefinitionId+"','"+a.activityName.replace("\r\n"," ")+"')\">",o+=a.activityName,o+="</a>",o+="</td>",i!=this.calledWorkflows.length-1&&(o+="<td class='eaWorkflowInstanceN-MainRegion-contentWfInstanceN-progress-icon'></td>")}o+="</tr></table>",e=n.Element.parse(o);var s=this.view.getWfInstanceNProgress();s.append(e)}.bind(this)}),prgdiagRenderCallActProgress=function(n,e,t){this.activeWorkflowDefinitionId=e,this.activeWorkflowInstanceId=n,this.workflowName=t,this.view.getWfInstanceNProgress().children()[0].remove(),this.redrawDiagram({id:e,shortWorkflowInstanceId:n,name:t})}.bind(this)},redrawDiagram:function(n){this.hasOwnProperty("bpmnDiagram")&&(this.bpmnDiagram.destroy(),delete this.bpmnDiagram,this.showDiagram(n))},zoomIn:function(){this.bpmnDiagram.bpmnDiagram.zoom(this.factor+=.1)},zoomOut:function(){this.factor>=.4&&this.bpmnDiagram.bpmnDiagram.zoom(this.factor-=.1)},showDiagram:function(n){this.bpmnDiagram&&(this.bpmnDiagram.detach(),this.bpmnDiagram.destroy(),this.bpmnDiagram=null),this.activeWorkflowDefinitionId=n.id,this.activeWorkflowInstanceId=n.shortWorkflowInstanceId,l.build({workflowDefinitionId:n.id,workflowInstanceId:n.shortWorkflowInstanceId,success:function(e){this.wfStructureModel=e.wfStructureModel,this.wfProgressModel=e.wfProgressModel,this.keyableStatus=e.keyableStatus,this.keyableCount=e.keyableCount,this.percentComplete=e.percentComplete,this.calledWorkflows=e.calledWorkflows;var t=this.buildOverlays(this.keyableStatus,this.keyableCount);this.options.regionEventBus.eventBus.publish("updatePercentage",this.percentComplete);var o;try{var i=6e4*(new Date).getTimezoneOffset(),a=new Date(this.wfProgressModel.attributes.nodeProgresses[0].events[0].time+i);o=a.toISOString().split(".")[0]}catch(l){o=this.wfProgressModel.attributes.nodeProgresses[0].events[0].time}this.options.regionEventBus.eventBus.publish("updateTimestamp",o),this.bpmnDiagram||(this.bpmnDiagram=new r({xid:"prg-",wfDefinitionId:n.id,wfName:n.name,highlights:t.highlights,countBadges:t.countBadges}),this.bpmnDiagram.addEventHandler("addCalledWorkflows",this.addCalledWorkflows.bind(this)),this.bpmnDiagram.attachTo(this.view.getContentDiagram()),this.options.regionEventBus.eventBus.publish("updateSidebars",n.shortWorkflowInstanceId)),this.wfDetails&&(this.wfDetails.detach(),this.wfDetails.destroy()),this.wfDetails=new s({}),this.factor=1,this.wfDetails.addEventHandler("zoomOut",this.zoomOut.bind(this)),this.wfDetails.addEventHandler("zoomIn",this.zoomIn.bind(this)),this.wfDetails.attachTo(this.view.getContentDetails()),this.wfDetails.addEventHandler("refreshProgress",this.refresh.bind(this))}.bind(this),error:function(n){console.log(n)}.bind(this)})}})}),define("styles!workflowinstancen/workflowInstanceN.less",function(){return'.eaWorkflowInstanceN-MainRegion {\n  padding-left: 45px;\n}\n.eaWorkflowInstanceN-MainRegion-Panel {\n  display: inline-block;\n  padding-top: 5px;\n  padding-bottom: 30px;\n}\n.eaWorkflowInstanceN-MainRegion-Panel-iconHolder {\n  margin-top: 1.2rem;\n  padding: 0.8rem 0;\n  background-color: #E6E6E6;\n  width: 1565px;\n  border-radius: 3px;\n  padding-left: 10px;\n}\n.eaWorkflowInstanceN-MainRegion-Panel-DeleteInstance {\n  display: inline-block;\n  padding-right: 5px;\n  cursor: pointer;\n  cursor: hand;\n}\n.eaWorkflowInstanceN-MainRegion-Panel-DuplicateInstance {\n  display: inline-block;\n  cursor: pointer;\n  cursor: hand;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-progress {\n  padding-right: 5px;\n  font-size: 12px;\n  margin: 0;\n  padding: 6px;\n  display: inline-block;\n  vertical-align: middle;\n  text-decoration: none;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-progress-icon {\n  vertical-align: middle;\n  padding: 0 4px;\n  background: url("workflowinstancen/resources/workflowinstancen/crumb_arrow.svg") no-repeat 50%;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-contentDiagram {\n  padding-left: 310px;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-comments {\n  margin: 10px 0px 0px 0px;\n  width: 550px;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-Buttons {\n  padding: 3px;\n  min-width: 40px;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home {\n  overflow: hidden;\n  width: 300px;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-UserActivity {\n  display: none;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-BottomDivider {\n  border-bottom: 1px solid #666666;\n  width: 250px;\n  padding-top: 5px;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-UserActivity2 {\n  display: block;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Section {\n  padding-top: 12px;\n  position: absolute;\n  width: 250px;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Section-Buttons {\n  padding: 3px;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Section-Buttons-buttonBack {\n  float: left;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Completed {\n  padding-top: 5px;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Completed {\n  padding-top: 5px;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Percentage {\n  padding-top: 20px;\n  padding-bottom: 20px;\n  font-size: 5rem;\n  color: #89ba17;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Started {\n  padding-top: 20px;\n  padding-bottom: 5px;\n  display: inline-block;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-StartedName {\n  padding-top: 20px;\n  padding-bottom: 5px;\n  display: inline-block;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Divider {\n  border-bottom: 1px solid #666666;\n  width: 1565px;\n  padding-top: 5px;\n  padding-bottom: 5px;\n}\n.eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Divider2 {\n  border-bottom: #cccccc solid 1px;\n  width: 250px;\n  padding-bottom: 15px;\n}\n.elLayouts-TopSection {\n  margin-left: 0px ! important;\n  margin-right: 70px ! important;\n}\n.elLayouts-TopSection-breadcrumb {\n  padding-top: 0px !important;\n}\n.elLayouts-Wrapper {\n  overflow: none ! important;\n}\n.eaContainer-applicationHolder {\n  top: 24px !important;\n}\n'}),define("text!workflowinstancen/workflowInstanceN.html",function(){return'<div class="eaWorkflowInstanceN-MainRegion">\r\n	<div class="eaWorkflowInstanceN-MainRegion-Panel"></div>\r\n	<div class="eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home"></div>\r\n	<div\r\n		class="eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-UserActivity2">\r\n		<div\r\n			class="eaWorkflowInstanceN-MainRegion-contentWfInstanceN-contentDiagram">\r\n			<div\r\n				class="eaWorkflowInstanceN-MainRegion-contentWfInstanceN-contentDetails"></div>\r\n		</div>\r\n	</div>'}),define("workflowinstancen/WorkflowInstanceNView",["jscore/core","text!./workflowInstanceN.html","styles!./workflowInstanceN.less"],function(n,e,t){return n.View.extend({getTemplate:function(){return e},getStyle:function(){return t},getBreadcrumb:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-Breadcrumb")},getWfInstanceNContent:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home")},getContentDiagram:function(){return this.getElement().find(".eaNFE_automation_UI-WfComment")},getBackButton:function(){return this.getElement().find(".eaNFE_automation_UI-WfDetails-buttonBack")},getWfInstanceNProgress:function(){return this.getElement().find(".eaNFE_automation_UI-WfDetails-progress")},getBarCell:function(){return this.getElement().find(".eaWorkflowHistory-MainRegion-contentWfInstanceN-home-StatusBar")},getTitle1:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-Title1")},getTitle2:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-Title2")},getPercentage:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Percentage")},getStartTime:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-Started")},getBarPercentageCell:function(){return this.getElement().find(".eaNFE_automation_UI-WfBarCell-contentTable-BarCell")},getUserTaskFormContent:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-UserTaskForm")},getUserActivityContent:function(){return this.getElement().find(".elLayouts-SlidingPanels-rightContents")},getUserActivityContent2:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-contentWfInstanceN-home-UserActivity2")},getRefreshButton:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-contentWfInstanceN-buttonRefresh")},addRefreshClickHandler:function(n){this.getElement().find(".eaNFE_automation_UI-WfDetails-buttonRefresh").addEventHandler("click",n)},getContentDetails:function(){return this.getElement().find(".eaWorkflowInstanceN-MainRegion-contentWfInstanceN-contentDetails")}})}),define("workflowinstancen/WorkflowInstanceN",["jscore/core","./WorkflowInstanceNView","jscore/ext/mvp","widgets/Breadcrumb","widget/WfUsertasks/WfUsertasks","widget/WfUsertasks/TaskFormOnDrilldown/TaskFormOnDrilldown","widget/WfDetails/WfDetails","widget/WfUsertasks/TaskTable/TaskActionsCell/TaskActionsCellView","widgets/table/Cell","widget/WfDiagram/WfDiagram","widget/WfProgress/WfProgressModel","widget/WfBarCell/WfBarCell","3pps/wfs/WfInstanceClient","widgets/SelectBox","jscore/ext/locationController","widget/WfComment/WfComment","3pps/wfs/WfUsertaskClient","layouts/TopSection","layouts/SlidingPanels","widget/WorkflowProgressSide/WorkflowProgressSide","./region/WorkflowInstanceNRegion/WorkflowInstanceNRegion"],function(n,e,t,o,a,s,r,l,c,d,f,g,h,w,m,u,p,k,I,W,b){return n.App.extend({View:e,updateURLParams:function(){var n=window.location.hash,e=n.substring(n.indexOf("/")+1).split("/");this.params={id:e[0],name:e[1],shortWorkflowInstanceId:e[2],startTime:e[3],workflowVersion:e[4]}},onAttach:function(){this.updateAll(),this.hideForm(),this.view.getUserActivityContent().setStyle("display","none"),this.workflowRegion.showDiagram(this.params)},updateAll:function(){this.updateURLParams(),this.activeWorkflowDefinitionId=this.params.id,this.activeWorkflowInstanceId=this.params.shortWorkflowInstanceId,this.workflowName=this.params.name,this.checkForUserTask()},onStart:function(){this.updateAll(),this.getContext().eventBus.subscribe("updateSidebars",function(n){this.activeWorkflowInstanceId=n,this.checkForUserTask()}.bind(this)),this.getContext().eventBus.subscribe("redrawDiagram",function(){this.workflowRegion.showDiagram(this.params)}.bind(this)),this.getContext().eventBus.subscribe("removeCommentSection",function(n){this.slidingPanels.rightShown&&this.slidingPanels.toggleRightPanel(),this.slidingPanels.rightButton.hide()}.bind(this)),this.getContext().eventBus.subscribe("toggleCommentSection",function(n){this.slidingPanels.rightShown&&this.slidingPanels.toggleRightPanel()}.bind(this));var n=this.options.breadcrumb,e=[{name:"ENM",url:"#workflowmanager"}];for(i=1;i<n.length;i++)e.push(n[i]);var t={name:"Workflow Manager",url:"#workflowmanager",children:[{name:"All Workflow Instances",url:"#workflowmanager/allworkflowinstances"},{name:"Active Tasks",url:"#workflowmanager/activetasks"},{name:"Workflow History",url:"#workflowmanager/workflowhistory"}]};e.splice(1,0,t),this.layout=new k({context:this.getContext(),title:"Workflow Instance",breadcrumb:e,defaultActions:[{type:"link",color:"blue",name:"All Workflow Instances",link:"#",action:function(){var n=new m,e="workflowmanager/allworkflowinstances";n.setLocation(e,!1)}},{type:"separator"},{type:"link",color:"blue",name:"All Active Tasks",link:"#",action:function(){var n=new m,e="workflowmanager/activetasks";n.setLocation(e,!1)}},{type:"separator"},{type:"link",color:"blue",name:"Workflow History",link:"#",action:function(){var n=new m,e="workflowmanager/workflowhistory";n.setLocation(e,!1)}}]}),this.workflowRegion=new b({regionEventBus:this.getContext()}),this.wfComment=new u({eventBus:this.getContext().eventBus}),this.workflowProgressSide=new W({regionEventBus:this.getContext()}),this.slidingPanels=new I({context:this.getContext(),main:{label:"Main Body",contents:this.workflowRegion},right:{label:"Comments",expanded:!1,contents:this.wfComment},left:{label:"Overview",expanded:!0,contents:this.workflowProgressSide}}),this.layout.attachTo(this.getElement()),this.layout.setContent(this.slidingPanels)},checkForUserTask:function(){this.wfComment&&(this.wfComment.detach(),this.wfComment.destroy(),this.wfComment=null),h.getActiveTasks({processInstanceId:this.activeWorkflowInstanceId,unfinished:!0,activityType:"userTask",success:function(n){if(null!=n&&n.length>0?(this.view.getUserActivityContent().setStyle("display","block"),this.workflowProgressSide.view.getUserTaskFormContent().setStyle("display","block"),this.slidingPanels.rightButton.show(),this.taskId=n[0].taskId):(this.workflowProgressSide.view.getUserTaskFormContent().setStyle("display","none"),this.slidingPanels.rightButton.hide(),this.slidingPanels.rightShown&&this.slidingPanels.toggleRightPanel()),null!==this.taskId||void 0!==this.taskId){var e=new t.Model;0!=n.length?(e.setAttribute("id",this.taskId),e.setAttribute("name",n[0].activityType),e.setAttribute("workflowDefinitionId",n[0].processDefinitionId),e.setAttribute("workflowName",n[0].activityName),e.setAttribute("workflowVersion","1"),e.setAttribute("shortWorkflowInstanceId",n[0].processInstanceId),e.setAttribute("workflowInstanceId",n[0].executionId),this.hideForm(),this.taskForm||(this.taskForm=new s({wfUsertaskModel:e,minHeight:"0px",taskHandledCallback:this.taskHandledCallback.bind(this)}),this.taskForm.addEventHandler("toggleContentDrilldown",this.toggleContentDrilldown.bind(this))),this.taskForm.attachTo(this.view.getUserTaskFormContent()),this.wfComment=new u({taskId:this.taskId,shortWorkflowInstanceId:this.params.shortWorkflowInstanceId,eventBus:this.getContext().eventBus}),this.wfComment.addEventHandler("toggleContentDrilldown",this.toggleContentDrilldown.bind(this)),this.wfComment.attachTo(this.view.getUserActivityContent())):this.taskId||this.getContext().eventBus.publish("removeCommentSection","removeComments")}}.bind(this)})},taskHandledCallback:function(n){1==n&&setTimeout(function(){this.getContext().eventBus.publish("something-changed","usertasks")}.bind(this),2e3);var e=new m,t="workflowsinstances/"+this.params.id+"/"+this.params.name;e.setLocation(t,!1),e.start()},hideForm:function(){null!=this.taskForm&&(this.taskForm.detach(),this.taskForm=null),null!=this.wfComment&&(this.wfComment.detach(),this.wfComment=null)},hideProgress:function(){null!=this.WfProgress&&(this.WfProgress.destroy(),this.WfProgress=null)},buildOverlays:function(n,e){var t=[],o=[];for(var i in n){var a=n[i];if(a&&null!=a&&""!==a){t.push({nodeId:i,style:"highlight-"+a});var s=e[i];s&&s>0&&(s>1||1==s&&"Started"===a)&&o.push({nodeId:i,count:s})}}return{highlights:t,countBadges:o}},showBackButton:function(){this.backButton.setStyle("display","block")},toggleContentDrilldown:function(n){this.checkForUserTask()},showFullDiagram:function(){this.bpmnDiagram.bpmnDiagram.zoom(1)},showZoomed:function(){this.bpmnDiagram.bpmnDiagram.zoom(1.5)}})});